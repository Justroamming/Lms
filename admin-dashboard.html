<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="css/admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @media (max-width: 640px) {
            .popup {
                width: 90%;
                padding: 1rem;
            }
            
            .popup-icon {
                font-size: 2rem;
            }
            
            .popup-title {
                font-size: 1.125rem;
            }
        }
    </style>
</head>
<body>
    <div class="overlay" id="sidebarOverlay"></div>
    <div class="dashboard">
        <div class="sidebar" id="sidebar">
            <div class="logo">
                <h2>Admin Dashboard</h2>
            </div>
            <ul>
                <li data-page="dashboard" class="active">
                    <i class="fas fa-home"></i> Tổng quan
                </li>
                <li data-page="students">
                    <i class="fas fa-user-graduate"></i> Quản lý học sinh
                </li>
                <li data-page="teachers">
                    <i class="fas fa-chalkboard-teacher"></i> Quản lý giáo viên
                </li>
                <li data-page="cohorts">
                    <i class="fas fa-school"></i> Quản lý lớp học
                </li>
                <li data-page="subjects">
                    <i class="fas fa-book"></i> Quản lý môn học
                </li>
                <li data-page="assignments">
                    <i class="fas fa-tasks"></i> Phân công giảng dạy
                </li>
            </ul>
        </div>
        <div class="main-content">
            <div class="topbar">
                <button id="menuToggle" class="menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="user-info">
                    <span>Admin</span>
                    <button onclick="logout()" class="btn-logout">
                        <i class="fas fa-sign-out-alt"></i> <span>Đăng xuất</span>
                    </button>
                </div>
            </div>
            <div id="pageContent"></div>
        </div>
    </div>
    
    <!-- Confirmation Popup -->
    <div class="popup-container" id="confirmationPopup">
        <div class="popup">
            <div class="popup-icon warning">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <h3 class="popup-title">Xác nhận</h3>
            <p class="popup-message" id="confirmationMessage">Bạn có chắc chắn muốn thực hiện thao tác này?</p>
            <div class="popup-actions">
                <button class="popup-btn popup-btn-cancel" id="cancelButton">Hủy</button>
                <button class="popup-btn popup-btn-confirm" id="confirmButton">Xác nhận</button>
            </div>
        </div>
    </div>
    
    <!-- Notification Popup -->
    <div class="popup-container" id="notificationPopup">
        <div class="popup">
            <div class="popup-icon success" id="notificationIcon">
                <i class="fas fa-check-circle"></i>
            </div>
            <p class="popup-message" id="notificationMessage">Thao tác đã được thực hiện thành công!</p>
            <div class="popup-actions">
                <button class="popup-btn popup-btn-ok" id="okButton">OK</button>
            </div>
        </div>
    </div>

    <script src="js/auth.js"></script>
    <script src="js/admin.js"></script>
    <script>
  
        
        // Kiểm tra quyền admin
        document.addEventListener('DOMContentLoaded', () => {
            const user = getCurrentUser();
            if (!user || user.role !== 'admin') {
                window.location.href = 'login.html';
            }
            
            // Khởi tạo sự kiện đóng modal khi click ra ngoài
            adminDashboard.setupModalOutsideClick();
            
            // Mobile sidebar toggle
            const menuToggle = document.getElementById('menuToggle');
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            menuToggle.addEventListener('click', () => {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            });
            
            // Close sidebar when clicking on overlay
            overlay.addEventListener('click', () => {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            });
            
            // Close sidebar when clicking on menu items (on mobile)
            const menuItems = document.querySelectorAll('.sidebar li');
            menuItems.forEach(item => {
                item.addEventListener('click', () => {
                    if (window.innerWidth <= 768) {
                        sidebar.classList.remove('open');
                        overlay.classList.remove('active');
                    }
                });
            });
            
            // Handle window resize
            window.addEventListener('resize', () => {
                if (window.innerWidth > 768) {
                    sidebar.classList.remove('open');
                    overlay.classList.remove('active');
                }
            });
            
            // Cập nhật popup handlers
            const confirmationPopup = document.getElementById('confirmationPopup');
            const confirmBtn = document.getElementById('confirmButton');
            const cancelBtn = document.getElementById('cancelButton');
            const okBtn = document.getElementById('okButton');
            
            if (confirmBtn) {
                confirmBtn.addEventListener('click', () => {
                    confirmationPopup.classList.remove('active');
                });
            }
            
            if (cancelBtn) {
                cancelBtn.addEventListener('click', () => {
                    confirmationPopup.classList.remove('active');
                });
            }
            
            if (okBtn) {
                okBtn.addEventListener('click', () => {
                    const notificationPopup = document.getElementById('notificationPopup');
                    if (notificationPopup) {
                        notificationPopup.classList.remove('active');
                    }
                });
            }
        });
        
        // Hiển thị notification
        function showNotification(message, type = 'info') {
            const notificationPopup = document.getElementById('notificationPopup');
            const notificationIcon = document.getElementById('notificationIcon');
            const notificationMessage = document.getElementById('notificationMessage');
            
            // Set icon based on type
            notificationIcon.className = 'popup-icon';
            switch(type) {
                case 'success':
                    notificationIcon.classList.add('success');
                    notificationIcon.innerHTML = '<i class="fas fa-check-circle"></i>';
                    break;
                case 'error':
                    notificationIcon.classList.add('error');
                    notificationIcon.innerHTML = '<i class="fas fa-times-circle"></i>';
                    break;
                case 'warning':
                    notificationIcon.classList.add('warning');
                    notificationIcon.innerHTML = '<i class="fas fa-exclamation-triangle"></i>';
                    break;
                default:
                    notificationIcon.classList.add('info');
                    notificationIcon.innerHTML = '<i class="fas fa-info-circle"></i>';
            }
            
            notificationMessage.textContent = message;
            notificationPopup.classList.add('active');
            
            // Auto hide after 3 seconds for success and info
            if (type === 'success' || type === 'info') {
                setTimeout(() => {
                    notificationPopup.classList.remove('active');
                }, 3000);
            }
        }
        
        // Hiển thị confirmation dialog
        function showConfirmation(message, onConfirm) {
            const confirmationPopup = document.getElementById('confirmationPopup');
            const confirmationMessage = document.getElementById('confirmationMessage');
            const confirmButton = document.getElementById('confirmButton');
            
            confirmationMessage.textContent = message;
            confirmationPopup.classList.add('active');
            
            // Remove previous event listeners
            const newConfirmBtn = confirmButton.cloneNode(true);
            confirmButton.parentNode.replaceChild(newConfirmBtn, confirmButton);
            
            // Add new event listener
            newConfirmBtn.addEventListener('click', () => {
                confirmationPopup.classList.remove('active');
                if (typeof onConfirm === 'function') {
                    onConfirm();
                }
            });
        }
        
   
    </script>
</body>
</html> 